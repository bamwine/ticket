(function(c){var b="calendarsPicker";c.JQPlugin.createPlugin({name:b,defaultRenderer:{picker:'<div class="datepicker {popup:start} datepicker-dropdown dropdown-menu datepicker-orient-left datepicker-orient-top {popup:end} {inline:start} datepicker-inline{inline:end}" style="display:block;"><div class="datepicker-days" style="display:block;">{months}',monthRow:'<table class="table-condensed"><div class="ui-datepicker-row-break">{months}</div>',month:'<thead><tr>{link:prev}<th class="datepicker-switch" colspan="5">{monthHeader:MM yyyy}</th>{link:next}</tr><tr>{weekHeader}</tr></thead><tbody>{weeks}</tbody></table></div>',weekHeader:"<tr>{days}</tr>",dayHeader:"<th>{day}</th>",week:"<tr>{days}</tr>",day:"{day}",monthSelector:".datepicker-days",daySelector:"td",rtlClass:"datepicker-rtl",multiClass:"ui-datepicker-multi",defaultClass:"day",selectedClass:"active",todayClass:"today",otherMonthClass:"old",commandClass:"datepicker-cmd",commandButtonClass:"ui-state-default ui-corner-all",commandLinkClass:"",disabledClass:"disabled"},commands:{prev:{text:"prevText",status:"prevStatus",keystroke:{keyCode:33},enabled:function(e){var d=e.curMinDate();return(!d||e.drawDate.newDate().add(1-e.options.monthsToStep-e.options.monthsOffset,"MM").day(e.options.calendar.minDay).add(-1,"d").compareTo(d)!==-1)},date:function(d){return d.drawDate.newDate().add(-d.options.monthsToStep-d.options.monthsOffset,"MM").day(d.options.calendar.minDay)},action:function(d){a.changeMonth(this,-d.options.monthsToStep)}},prevJump:{text:"prevJumpText",status:"prevJumpStatus",keystroke:{keyCode:33,ctrlKey:true},enabled:function(e){var d=e.curMinDate();return(!d||e.drawDate.newDate().add(1-e.options.monthsToJump-e.options.monthsOffset,"MM").day(e.options.calendar.minDay).add(-1,"d").compareTo(d)!==-1)},date:function(d){return d.drawDate.newDate().add(-d.options.monthsToJump-d.options.monthsOffset,"MM").day(d.options.calendar.minDay)},action:function(d){a.changeMonth(this,-d.options.monthsToJump)}},next:{text:"nextText",status:"nextStatus",keystroke:{keyCode:34},enabled:function(d){var e=d.get("maxDate");return(!e||d.drawDate.newDate().add(d.options.monthsToStep-d.options.monthsOffset,"MM").day(d.options.calendar.minDay).compareTo(e)!==+1)},date:function(d){return d.drawDate.newDate().add(d.options.monthsToStep-d.options.monthsOffset,"MM").day(d.options.calendar.minDay)},action:function(d){a.changeMonth(this,d.options.monthsToStep)}},nextJump:{text:"nextJumpText",status:"nextJumpStatus",keystroke:{keyCode:34,ctrlKey:true},enabled:function(d){var e=d.get("maxDate");return(!e||d.drawDate.newDate().add(d.options.monthsToJump-d.options.monthsOffset,"MM").day(d.options.calendar.minDay).compareTo(e)!==+1)},date:function(d){return d.drawDate.newDate().add(d.options.monthsToJump-d.options.monthsOffset,"MM").day(d.options.calendar.minDay)},action:function(d){a.changeMonth(this,d.options.monthsToJump)}},current:{text:"currentText",status:"currentStatus",keystroke:{keyCode:36,ctrlKey:true},enabled:function(f){var e=f.curMinDate();var g=f.get("maxDate");var d=f.selectedDates[0]||f.options.calendar.today();return(!e||d.compareTo(e)!==-1)&&(!g||d.compareTo(g)!==+1)},date:function(d){return d.selectedDates[0]||d.options.calendar.today()},action:function(e){var d=e.selectedDates[0]||e.options.calendar.today();a.showMonth(this,d.year(),d.month())}},today:{text:"todayText",status:"todayStatus",keystroke:{keyCode:36,ctrlKey:true},enabled:function(e){var d=e.curMinDate();var f=e.get("maxDate");return(!d||e.options.calendar.today().compareTo(d)!==-1)&&(!f||e.options.calendar.today().compareTo(f)!==+1)},date:function(d){return d.options.calendar.today()},action:function(d){a.showMonth(this)}},clear:{text:"clearText",status:"clearStatus",keystroke:{keyCode:35,ctrlKey:true},enabled:function(d){return true},date:function(d){return null},action:function(d){a.clear(this)}},close:{text:"closeText",status:"closeStatus",keystroke:{keyCode:27},enabled:function(d){return true},date:function(d){return null},action:function(d){a.hide(this)}},prevWeek:{text:"prevWeekText",status:"prevWeekStatus",keystroke:{keyCode:38,ctrlKey:true},enabled:function(e){var d=e.curMinDate();return(!d||e.drawDate.newDate().add(-e.options.calendar.daysInWeek(),"d").compareTo(d)!==-1)},date:function(d){return d.drawDate.newDate().add(-d.options.calendar.daysInWeek(),"d")},action:function(d){a.changeDay(this,-d.options.calendar.daysInWeek())}},prevDay:{text:"prevDayText",status:"prevDayStatus",keystroke:{keyCode:37,ctrlKey:true},enabled:function(e){var d=e.curMinDate();return(!d||e.drawDate.newDate().add(-1,"d").compareTo(d)!==-1)},date:function(d){return d.drawDate.newDate().add(-1,"d")},action:function(d){a.changeDay(this,-1)}},nextDay:{text:"nextDayText",status:"nextDayStatus",keystroke:{keyCode:39,ctrlKey:true},enabled:function(d){var e=d.get("maxDate");return(!e||d.drawDate.newDate().add(1,"d").compareTo(e)!==+1)},date:function(d){return d.drawDate.newDate().add(1,"d")},action:function(d){a.changeDay(this,1)}},nextWeek:{text:"nextWeekText",status:"nextWeekStatus",keystroke:{keyCode:40,ctrlKey:true},enabled:function(d){var e=d.get("maxDate");return(!e||d.drawDate.newDate().add(d.options.calendar.daysInWeek(),"d").compareTo(e)!==+1)},date:function(d){return d.drawDate.newDate().add(d.options.calendar.daysInWeek(),"d")},action:function(d){a.changeDay(this,d.options.calendar.daysInWeek())}}},defaultOptions:{calendar:c.calendars.instance(),pickerClass:"",showOnFocus:true,showTrigger:".datepicker-trigger:eq(0)",showAnim:"",showOptions:{},showSpeed:"normal",popupContainer:"#research.modal .modal-content",alignment:"bottom",fixedWeeks:false,firstDay:null,calculateWeek:null,monthsToShow:1,monthsOffset:0,monthsToStep:1,monthsToJump:12,useMouseWheel:true,changeMonth:true,yearRange:"c-100:c+100",showOtherMonths:true,selectOtherMonths:true,defaultDate:null,selectDefaultDate:false,minDate:"d",maxDate:null,dateFormat:"yyyy-mm-dd",autoSize:false,rangeSelect:false,rangeSeparator:" - ",multiSelect:0,multiSeparator:",",onDate:null,onShow:null,onChangeMonthYear:null,onSelect:null,onClose:null,altField:null,altFormat:"$",constrainInput:true,commandsAsDateFormat:false,commands:{}},regionalOptions:{"":{renderer:{},prevText:"«",prevStatus:"Show the previous month",prevJumpText:"&lt;&lt;",prevJumpStatus:"Show the previous year",nextText:"»",nextStatus:"Show the next month",nextJumpText:"&gt;&gt;",nextJumpStatus:"Show the next year",currentText:"Current",currentStatus:"Show the current month",todayText:"Today",todayStatus:"Show today's month",clearText:"Clear",clearStatus:"Clear all the dates",closeText:"Close",closeStatus:"Close the datepicker",yearStatus:"Change the year",monthStatus:"Change the month",weekText:"Wk",weekStatus:"Week of the year",dayStatus:"Select DD, M d, yyyy",defaultStatus:"Select a date",isRTL:false}},_getters:["getDate","isDisabled","isSelectable","retrieveDate"],_disabled:[],_popupClass:"calendars-popup",_triggerClass:"calendars-trigger",_disableClass:"calendars-disable",_monthYearClass:"calendars-month-year",_curMonthClass:"calendars-month-",_anyYearClass:"calendars-any-year",_curDoWClass:"calendars-dow-",_yearClass:"calendars-dow-",_monthClass:"calendars-dow-",_init:function(){this.defaultOptions.commands=this.commands;this.regionalOptions[""].renderer=this.defaultRenderer;this._super()},_instSettings:function(e,d){return{selectedDates:[],drawDate:null,pickingRange:false,inline:(c.inArray(e[0].nodeName.toLowerCase(),["div","span"])>-1),get:function(f){if(c.inArray(f,["defaultDate","minDate","maxDate"])>-1){return this.options.calendar.determineDate(this.options[f],null,this.selectedDates[0],this.get("dateFormat"),this.getConfig())}if(f==="dateFormat"){return this.options.dateFormat||this.options.calendar.local.dateFormat}return this.options[f]},curMinDate:function(){return(this.pickingRange?this.selectedDates[0]:this.get("minDate"))},getConfig:function(){return{dayNamesShort:this.options.dayNamesShort,dayNames:this.options.dayNames,monthNamesShort:this.options.monthNamesShort,monthNames:this.options.monthNames,calculateWeek:this.options.calculateWeek,shortYearCutoff:this.options.shortYearCutoff}}}},_postAttach:function(d,e){if(e.inline){e.drawDate=a._checkMinMax((e.selectedDates[0]||e.get("defaultDate")||e.options.calendar.today()).newDate(),e);e.prevDate=e.drawDate.newDate();this._update(d[0]);if(c.fn.mousewheel){d.mousewheel(this._doMouseWheel)}}else{this._attachments(d,e);d.on("keydown."+e.name,this._keyDown).on("keypress."+e.name,this._keyPress).on("keyup."+e.name,this._keyUp);if(d.attr("disabled")){this.disable(d[0])}}},_optionsChanged:function(e,f,d){if(d.calendar&&d.calendar!==f.options.calendar){var j=function(k){return(typeof f.options[k]==="object"?null:f.options[k])};d=c.extend({defaultDate:j("defaultDate"),minDate:j("minDate"),maxDate:j("maxDate")},d);f.selectedDates=[];f.drawDate=null}var i=f.selectedDates;c.extend(f.options,d);this.setDate(e[0],i,null,false,true);f.pickingRange=false;var h=f.options.calendar;var g=f.get("defaultDate");f.drawDate=this._checkMinMax((g?g:f.drawDate)||g||h.today(),f).newDate();if(!f.inline){this._attachments(e,f)}if(f.inline||f.div){this._update(e[0])}},_attachments:function(e,f){e.off("focus."+f.name);if(f.options.showOnFocus){e.on("focus."+f.name,this.show)}if(f.trigger){f.trigger.remove()}var d=f.options.showTrigger;f.trigger=(!d?c([]):c(d).clone().removeAttr("id").addClass(this._triggerClass)[f.options.isRTL?"insertBefore":"insertAfter"](e).click(function(){if(!a.isDisabled(e[0])){a[a.curInst===f?"hide":"show"](e[0])}}));this._autoSize(e,f);var h=this._extractDates(f,e.val());if(h){this.setDate(e[0],h,null,true)}var g=f.get("defaultDate");if(f.options.selectDefaultDate&&g&&f.selectedDates.length===0){this.setDate(e[0],(g||f.options.calendar.today()).newDate())}},_autoSize:function(g,h){if(h.options.autoSize&&!h.inline){var i=h.options.calendar;var f=i.newDate(2009,10,20);var d=h.get("dateFormat");if(d.match(/[DM]/)){var e=function(m){var j=0;var k=0;for(var l=0;l<m.length;l++){if(m[l].length>j){j=m[l].length;k=l}}return k};f.month(e(i.local[d.match(/MM/)?"monthNames":"monthNamesShort"])+1);f.day(e(i.local[d.match(/DD/)?"dayNames":"dayNamesShort"])+20-f.dayOfWeek())}h.elem.attr("size",f.formatDate(d).length)}},_preDestroy:function(d,e){if(e.trigger){e.trigger.remove()}d.empty().off("."+e.name);if(e.inline&&c.fn.mousewheel){d.unmousewheel()}if(!e.inline&&e.options.autoSize){d.removeAttr("size")}},multipleEvents:function(e){var d=arguments;return function(f){for(var g=0;g<d.length;g++){d[g].apply(this,arguments)}}},enable:function(d){d=c(d);if(!d.hasClass(this._getMarker())){return}var e=this._getInst(d);if(e.inline){d.children("."+this._disableClass).remove().end().find("button,select").prop("disabled",false).end().find("a").attr("href","javascript:void(0)")}else{d.prop("disabled",false);e.trigger.filter("button."+this._triggerClass).prop("disabled",false).end().filter("img."+this._triggerClass).css({opacity:"1.0",cursor:""})}this._disabled=c.map(this._disabled,function(f){return(f===d[0]?null:f)})},disable:function(d){d=c(d);if(!d.hasClass(this._getMarker())){return}var e=this._getInst(d);if(e.inline){var f=d.children(":last");var h=f.offset();var g={left:0,top:0};f.parents().each(function(){if(c(this).css("position")==="relative"){g=c(this).offset();return false}});var i=d.css("zIndex");i=(i==="auto"?0:parseInt(i,10))+1;d.prepend('<div class="'+this._disableClass+'" style="width: '+f.outerWidth()+"px; height: "+f.outerHeight()+"px; left: "+(h.left-g.left)+"px; top: "+(h.top-g.top)+"px; z-index: "+i+'"></div>').find("button,select").prop("disabled",true).end().find("a").removeAttr("href")}else{d.prop("disabled",true);e.trigger.filter("button."+this._triggerClass).prop("disabled",true).end().filter("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"})}this._disabled=c.map(this._disabled,function(j){return(j===d[0]?null:j)});this._disabled.push(d[0])},isDisabled:function(d){return(d&&c.inArray(d,this._disabled)>-1)},show:function(g){g=c(g.target||g);var i=a._getInst(g);if(a.curInst===i){return}if(a.curInst){a.hide(a.curInst,true)}if(!c.isEmptyObject(i)){i.lastVal=null;i.selectedDates=a._extractDates(i,g.val());i.pickingRange=false;i.drawDate=a._checkMinMax((i.selectedDates[0]||i.get("defaultDate")||i.options.calendar.today()).newDate(),i);i.prevDate=i.drawDate.newDate();a.curInst=i;a._update(g[0],true);var j=a._checkOffset(i);i.div.css({left:j.left,top:j.top});var d=i.options.showAnim;var f=i.options.showSpeed;f=(f==="normal"&&c.ui&&parseInt(c.ui.version.substring(2))>=8?"_default":f);if(c.effects&&(c.effects[d]||(c.effects.effect&&c.effects.effect[d]))){var h=i.div.data();for(var e in h){if(e.match(/^ec\.storage\./)){h[e]=i._mainDiv.css(e.replace(/ec\.storage\./,""))}}i.div.data(h).show(d,i.options.showOptions,f)}else{i.div[d||"show"](d?f:0)}}},_extractDates:function(k,g){if(g===k.lastVal){return}k.lastVal=g;g=g.split(k.options.multiSelect?k.options.multiSeparator:(k.options.rangeSelect?k.options.rangeSeparator:"\x00"));var l=[];for(var f=0;f<g.length;f++){var e=k.options.calendar.parseDate(k.get("dateFormat"),g[f]);if(e){var h=false;for(var d=0;d<l.length;d++){if(l[d].compareTo(e)===0){h=true;break}}if(!h){l.push(e)}}}l.splice(k.options.multiSelect||(k.options.rangeSelect?2:1),l.length);if(k.options.rangeSelect&&l.length===1){l[1]=l[0]}return l},_update:function(e,g){e=c(e.target||e);var f=a._getInst(e);var d=(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));if(!c.isEmptyObject(f)){if(f.inline||a.curInst===f){if(c.isFunction(f.options.onChangeMonthYear)&&(!f.prevDate||f.prevDate.year()!==f.drawDate.year()||f.prevDate.month()!==f.drawDate.month())){f.options.onChangeMonthYear.apply(e[0],[f.drawDate.year(),f.drawDate.month()])}}if(f.inline){e.html(this._generateContent(e[0],f))}else{if(a.curInst===f){if(!f.div){f.div=c("<div></div>").addClass(this._popupClass).css({display:(g?"none":"static"),position:"absolute",left:e.offset().left,top:e.offset().top+e.outerHeight(),zIndex:10000}).appendTo(c("body"));if(c.fn.mousewheel){f.div.mousewheel(this._doMouseWheel)}}if(d&&c(f.options.popupContainer).length){f.div.css("margin-top",(0-c(f.options.popupContainer).offset().top-4)+"px").appendTo(c(f.options.popupContainer))}f.div.html(this._generateContent(e[0],f));e.focus()}}}},_updateInput:function(f,e){var l=this._getInst(f);if(!c.isEmptyObject(l)){var m="";var g="";var n=(l.options.multiSelect?l.options.multiSeparator:l.options.rangeSeparator);var k=l.options.calendar;var d=l.get("dateFormat");var h=l.options.altFormat||d;for(var j=0;j<l.selectedDates.length;j++){m+=(e?"":(j>0?n:"")+k.formatDate(d,l.selectedDates[j]));g+=(j>0?n:"")+k.formatDate(h,l.selectedDates[j])}if(!l.inline&&!e){c(f).val(m)}c(l.options.altField).val(g);if(c.isFunction(l.options.onSelect)&&!e&&!l.inSelect){l.inSelect=true;l.options.onSelect.apply(f,[l.selectedDates]);l.inSelect=false}}},_getBorders:function(d){var e=function(f){return{thin:1,medium:3,thick:5}[f]||f};return[parseFloat(e(d.css("border-left-width"))),parseFloat(e(d.css("border-top-width")))]},_checkOffset:function(i){var e=(i.elem.is(":hidden")&&i.trigger?i.trigger:i.elem);var h=e.offset();var r=c(window).width();var j=c(window).height();if(r===0){return h}var f=false;var q=document.documentElement.scrollLeft||document.body.scrollLeft;var p=document.documentElement.scrollTop||document.body.scrollTop;var m=h.top-(f?p:0)-i.div.outerHeight();var o=h.top-(f?p:0)+e.outerHeight();var n=h.left-(f?q:0);var k=h.left-(f?q:0)+e.outerWidth()-i.div.outerWidth();var g=(h.left-q+i.div.outerWidth())>r;var d=(h.top-p+i.elem.outerHeight()+i.div.outerHeight())>j;i.div.css("position",f?"fixed":"absolute");var l=i.options.alignment;if(l==="topLeft"){h={left:n,top:m}}else{if(l==="topRight"){h={left:k,top:m}}else{if(l==="bottomLeft"){h={left:n,top:o}}else{if(l==="bottomRight"){h={left:k,top:o}}else{if(l==="top"){h={left:(i.options.isRTL||g?k:n),top:m}}else{h={left:(i.options.isRTL||g?k:n),top:(d?m:o)}}}}}}h.left=Math.max((f?0:q),h.left);h.top=Math.max((f?0:p),h.top);return h},_checkExternalClick:function(e){if(!a.curInst){return}var d=c(e.target);if(d.closest("."+a._popupClass+",."+a._triggerClass).length===0&&!d.hasClass(a._getMarker())){a.hide(a.curInst)}},hide:function(h,f){if(!h){return}var j=this._getInst(h);if(c.isEmptyObject(j)){j=h}if(j&&j===a.curInst){var e=(f?"":j.options.showAnim);var g=j.options.showSpeed;g=(g==="normal"&&c.ui&&parseInt(c.ui.version.substring(2))>=8?"_default":g);var i=function(){if(!j.div){return}j.div.remove();j.div=null;a.curInst=null;if(c.isFunction(j.options.onClose)){j.options.onClose.apply(h,[j.selectedDates])}};j.div.stop();if(c.effects&&(c.effects[e]||(c.effects.effect&&c.effects.effect[e]))){j.div.hide(e,j.options.showOptions,g,i)}else{var d=(e==="slideDown"?"slideUp":(e==="fadeIn"?"fadeOut":"hide"));j.div[d]((e?g:""),i)}if(!e){i()}}},_keyDown:function(g){var f=g.target;var h=a._getInst(f);var i=false;if(h.div){if(g.keyCode===9){a.hide(f)}else{if(g.keyCode===13){a.selectDate(f,c("a."+h.options.renderer.highlightedClass,h.div)[0]);i=true}else{var d=h.options.commands;for(var e in d){var j=d[e];if(j.keystroke.keyCode===g.keyCode&&!!j.keystroke.ctrlKey===!!(g.ctrlKey||g.metaKey)&&!!j.keystroke.altKey===g.altKey&&!!j.keystroke.shiftKey===g.shiftKey){a.performAction(f,e);i=true;break}}}}}else{var j=h.options.commands.current;if(j.keystroke.keyCode===g.keyCode&&!!j.keystroke.ctrlKey===!!(g.ctrlKey||g.metaKey)&&!!j.keystroke.altKey===g.altKey&&!!j.keystroke.shiftKey===g.shiftKey){a.show(f);i=true}}h.ctrlKey=((g.keyCode<48&&g.keyCode!==32)||g.ctrlKey||g.metaKey);if(i){g.preventDefault();g.stopPropagation()}return !i},_keyPress:function(f){var g=a._getInst(f.target);if(!c.isEmptyObject(g)&&g.options.constrainInput){var e=String.fromCharCode(f.keyCode||f.charCode);var d=a._allowedChars(g);return(f.metaKey||g.ctrlKey||e<" "||!d||d.indexOf(e)>-1)}return true},_allowedChars:function(k){var e=(k.options.multiSelect?k.options.multiSeparator:(k.options.rangeSelect?k.options.rangeSeparator:""));var j=false;var f=false;var d=k.get("dateFormat");for(var g=0;g<d.length;g++){var h=d.charAt(g);if(j){if(h==="'"&&d.charAt(g+1)!=="'"){j=false}else{e+=h}}else{switch(h){case"d":case"m":case"o":case"w":e+=(f?"":"0123456789");f=true;break;case"y":case"@":case"!":e+=(f?"":"0123456789")+"-";f=true;break;case"J":e+=(f?"":"0123456789")+"-.";f=true;break;case"D":case"M":case"Y":return null;case"'":if(d.charAt(g+1)==="'"){e+="'"}else{j=true}break;default:e+=h}}}return e},_keyUp:function(e){var d=e.target;var f=a._getInst(d);if(!c.isEmptyObject(f)&&!f.ctrlKey&&f.lastVal!==f.elem.val()){try{var g=a._extractDates(f,f.elem.val());if(g.length>0){a.setDate(d,g,null,true)}}catch(e){}}return true},_doMouseWheel:function(e,g){var d=(a.curInst&&a.curInst.elem[0])||c(e.target).closest("."+a._getMarker())[0];if(a.isDisabled(d)){return}var f=a._getInst(d);if(f.options.useMouseWheel){g=(g<0?-1:+1);a.changeMonth(d,-f.options[e.ctrlKey?"monthsToJump":"monthsToStep"]*g)}e.preventDefault()},clear:function(d){var e=this._getInst(d);if(!c.isEmptyObject(e)){e.selectedDates=[];this.hide(d);var f=e.get("defaultDate");if(e.options.selectDefaultDate&&f){this.setDate(d,(f||e.options.calendar.today()).newDate())}else{this._updateInput(d)}}},getDate:function(d){var e=this._getInst(d);return(!c.isEmptyObject(e)?e.selectedDates:[])},setDate:function(h,e,q,f,n){var p=this._getInst(h);if(!c.isEmptyObject(p)){if(!c.isArray(e)){e=[e];if(q){e.push(q)}}var m=p.get("minDate");var d=p.get("maxDate");var k=p.selectedDates[0];p.selectedDates=[];for(var o=0;o<e.length;o++){var g=p.options.calendar.determineDate(e[o],null,k,p.get("dateFormat"),p.getConfig());if(g){if((!m||g.compareTo(m)!==-1)&&(!d||g.compareTo(d)!==+1)){var r=false;for(var l=0;l<p.selectedDates.length;l++){if(p.selectedDates[l].compareTo(g)===0){r=true;break}}if(!r){p.selectedDates.push(g)}}}}p.selectedDates.splice(p.options.multiSelect||(p.options.rangeSelect?2:1),p.selectedDates.length);if(p.options.rangeSelect){switch(p.selectedDates.length){case 1:p.selectedDates[1]=p.selectedDates[0];break;case 2:p.selectedDates[1]=(p.selectedDates[0].compareTo(p.selectedDates[1])===+1?p.selectedDates[0]:p.selectedDates[1]);break}p.pickingRange=false}p.prevDate=(p.drawDate?p.drawDate.newDate():null);p.drawDate=this._checkMinMax((p.selectedDates[0]||p.get("defaultDate")||p.options.calendar.today()).newDate(),p);if(!n){this._update(h);this._updateInput(h,f)}}},isSelectable:function(e,d){var f=this._getInst(e);if(c.isEmptyObject(f)){return false}d=f.options.calendar.determineDate(d,f.selectedDates[0]||f.options.calendar.today(),null,f.options.dateFormat,f.getConfig());return this._isSelectable(e,d,f.options.onDate,f.get("minDate"),f.get("maxDate"))},_isSelectable:function(f,e,d,h,i){var g=(typeof d==="boolean"?{selectable:d}:(!c.isFunction(d)?{}:d.apply(f,[e,true])));return(g.selectable!==false)&&(!h||e.toJD()>=h.toJD())&&(!i||e.toJD()<=i.toJD())},performAction:function(e,g){var f=this._getInst(e);if(!c.isEmptyObject(f)&&!this.isDisabled(e)){var d=f.options.commands;if(d[g]&&d[g].enabled.apply(e,[f])){d[g].action.apply(e,[f])}}},showMonth:function(g,f,j,e){var h=this._getInst(g);if(!c.isEmptyObject(h)&&(e!=null||(h.drawDate.year()!==f||h.drawDate.month()!==j))){h.prevDate=h.drawDate.newDate();var i=h.options.calendar;var d=this._checkMinMax((f!=null?i.newDate(f,j,1):i.today()),h);h.drawDate.date(d.year(),d.month(),(e!=null?e:Math.min(h.drawDate.day(),i.daysInMonth(d.year(),d.month()))));this._update(g)}},changeMonth:function(e,g){var f=this._getInst(e);if(!c.isEmptyObject(f)){var d=f.drawDate.newDate().add(g,"MM");this.showMonth(e,d.year(),d.month())}},changeDay:function(e,g){var f=this._getInst(e);if(!c.isEmptyObject(f)){var d=f.drawDate.newDate().add(g,"d");this.showMonth(e,d.year(),d.month(),d.day())}},_checkMinMax:function(d,f){var e=f.get("minDate");var g=f.get("maxDate");d=(e&&d.compareTo(e)===-1?e.newDate():d);d=(g&&d.compareTo(g)===+1?g.newDate():d);return d},retrieveDate:function(d,f){var e=this._getInst(d);return(c.isEmptyObject(e)?null:e.options.calendar.fromJD(parseFloat(f.className.replace(/^.*jd(\d+\.5).*$/,"$1"))))},selectDate:function(f,j){var h=this._getInst(f);if(!c.isEmptyObject(h)&&!this.isDisabled(f)){var d=this.retrieveDate(f,j);if(h.options.multiSelect){var g=false;for(var e=0;e<h.selectedDates.length;e++){if(d.compareTo(h.selectedDates[e])===0){h.selectedDates.splice(e,1);g=true;break}}if(!g&&h.selectedDates.length<h.options.multiSelect){h.selectedDates.push(d)}}else{if(h.options.rangeSelect){if(h.pickingRange){h.selectedDates[1]=d}else{h.selectedDates=[d,d]}h.pickingRange=!h.pickingRange}else{h.selectedDates=[d]}}h.prevDate=d.newDate();this._updateInput(f);if(h.inline||h.pickingRange||h.selectedDates.length<(h.options.multiSelect||(h.options.rangeSelect?2:1))){this._update(f)}else{this.hide(f)}}},_generateContent:function(i,j){var o=j.options.monthsToShow;o=(c.isArray(o)?o:[1,o]);j.drawDate=this._checkMinMax(j.drawDate||j.get("defaultDate")||j.options.calendar.today(),j);var n=j.drawDate.newDate().add(-j.options.monthsOffset,"m");var m="";for(var q=0;q<o[0];q++){var f="";for(var h=0;h<o[1];h++){f+=this._generateMonth(i,j,n.year(),n.month(),j.options.calendar,j.options.renderer,(q===0&&h===0));n.add(1,"m")}m+=this._prepare(j.options.renderer.monthRow,j).replace(/\{months\}/,f)}var l=this._prepare(j.options.renderer.picker,j).replace(/\{months\}/,m).replace(/\{weekHeader\}/g,this._generateDayHeaders(j,j.options.calendar,j.options.renderer));var g=function(v,t,x,s,u){if(l.indexOf("{"+v+":"+s+"}")===-1){return}var w=j.options.commands[s];var r=(j.options.commandsAsDateFormat?w.date.apply(i,[j]):null);l=l.replace(new RegExp("\\{"+v+":"+s+"\\}","g"),"<"+t+(w.status?' title="'+j.options[w.status]+'"':"")+' class="'+s+" "+j.options.renderer.commandClass+" "+j.options.renderer.commandClass+"-"+s+" "+u+(w.enabled(j)?"":" "+j.options.renderer.disabledClass)+'">'+(r?r.formatDate(j.options[w.text]):j.options[w.text])+"</"+x+">")};for(var d in j.options.commands){g("button",'button type="button"',"button",d,j.options.renderer.commandButtonClass);g("link",'th style="display: table-cell;"',"th",d,j.options.renderer.commandLinkClass)}l=c(l);if(o[1]>1){var k=0;c(j.options.renderer.monthSelector,l).each(function(){var r=++k%o[1];c(this).addClass(r===1?"first":(r===0?"last":""))})}var p=this;l.find(j.options.renderer.daySelector+":not(."+j.options.renderer.disabledClass.replace(" ",".")+")").hover(function(){(j.inline?c(this).closest("."+p._getMarker()):j.div).find(j.options.renderer.daySelector).removeClass(j.options.renderer.highlightedClass);c(this).addClass(j.options.renderer.highlightedClass)},function(){(j.inline?c(this).closest("."+p._getMarker()):j.div).find(j.options.renderer.daySelector).removeClass(j.options.renderer.highlightedClass)}).click(function(){p.selectDate(i,this)}).end().find("select."+this._monthYearClass+":not(."+this._anyYearClass+")").change(function(){var r=c(this).val().split("/");p.showMonth(i,parseInt(r[1],10),parseInt(r[0],10))}).end().find("select."+this._anyYearClass).click(function(){c(this).css("visibility","hidden").next("input").css({left:this.offsetLeft,top:this.offsetTop,width:this.offsetWidth,height:this.offsetHeight}).show().focus()}).end().find("input."+p._monthYearClass).change(function(){try{var r=parseInt(c(this).val(),10);r=(isNaN(r)?j.drawDate.year():r);p.showMonth(i,r,j.drawDate.month(),j.drawDate.day())}catch(s){alert(s)}}).keydown(function(r){if(r.keyCode===13){c(r.elem).change()}else{if(r.keyCode===27){c(r.elem).hide().prev("select").css("visibility","visible");j.elem.focus()}}});l.find("."+j.options.renderer.commandClass).click(function(){if(!c(this).hasClass(j.options.renderer.disabledClass)){var r=this.className.replace(new RegExp("^.*"+j.options.renderer.commandClass+"-([^ ]+).*$"),"$1");a.performAction(i,r)}});if(j.options.isRTL){l.addClass(j.options.renderer.rtlClass)}if(o[0]*o[1]>1){l.addClass(j.options.renderer.multiClass)}if(j.options.pickerClass){l.addClass(j.options.pickerClass)}c("body").append(l);var e=0;l.find(j.options.renderer.monthSelector).each(function(){e+=c(this).outerWidth()});l.width(e/o[0]);if(c.isFunction(j.options.onShow)){j.options.onShow.apply(i,[l,j.options.calendar,j])}return l},_generateMonth:function(C,g,s,E,t,w,l){var d=t.daysInMonth(s,E);var e=g.options.monthsToShow;e=(c.isArray(e)?e:[1,e]);var n=g.options.fixedWeeks||(e[0]*e[1]>1);var p=g.options.firstDay;p=(p==null?t.local.firstDay:p);var I=(t.dayOfWeek(s,E,t.minDay)-p+t.daysInWeek())%t.daysInWeek();var j=(n?6:Math.ceil((I+d)/t.daysInWeek()));var u=g.options.selectOtherMonths&&g.options.showOtherMonths;var m=(g.pickingRange?g.selectedDates[0]:g.get("minDate"));var q=g.get("maxDate");var A=w.week.indexOf("{weekOfYear}")>-1;var D=t.today();var G=t.newDate(s,E,t.minDay);G.add(-I-(n&&(G.dayOfWeek()===p||G.daysInMonth()<t.daysInWeek())?t.daysInWeek():0),"d");var F=G.toJD();var k="";for(var x=0;x<j;x++){var H=(!A?"":'<span class="jd'+F+'">'+(c.isFunction(g.options.calculateWeek)?g.options.calculateWeek(G):G.weekOfYear())+"</span>");var h="";for(var z=0;z<t.daysInWeek();z++){var v=false;if(g.options.rangeSelect&&g.selectedDates.length>0){v=(G.compareTo(g.selectedDates[0])!==-1&&G.compareTo(g.selectedDates[1])!==+1)}else{for(var y=0;y<g.selectedDates.length;y++){if(g.selectedDates[y].compareTo(G)===0){v=true;break}}}var B=(!c.isFunction(g.options.onDate)?{}:g.options.onDate.apply(C,[G,G.month()===E]));var o=(u||G.month()===E)&&this._isSelectable(C,G,B.selectable,m,q);h+=this._prepare(w.day,g).replace(/\{day\}/g,("<td")+' class="jd'+F+" "+(B.dateClass||"")+(v&&(u||G.month()===E)?" "+w.selectedClass:"")+" "+(o?" "+w.defaultClass:w.disabledClass)+(G.weekDay()?"":" "+w.weekendClass)+(G.month()===E?"":" "+w.otherMonthClass)+(G.compareTo(D)===0&&G.month()===E?" "+w.todayClass:"")+(G.compareTo(g.drawDate)===0&&G.month()===E?" "+w.highlightedClass:"")+'"'+(B.title||(g.options.dayStatus&&o)?' title="'+(B.title||G.formatDate(g.options.dayStatus))+'"':"")+">"+window.convertDigits((g.options.showOtherMonths||G.month()===E?B.content||G.day():"&nbsp;").toString(),g.options.calendar.local.digits)+("</td>"));G.add(1,"d");F++}k+=this._prepare(w.week,g).replace(/\{days\}/g,h).replace(/\{weekOfYear\}/g,H)}var f=this._prepare(w.month,g).match(/\{monthHeader(:[^\}]+)?\}/);f=(f[0].length<=13?"MM yyyy":f[0].substring(13,f[0].length-1));f=(l?this._generateMonthSelection(g,s,E,m,q,f,t,w):t.formatDate(f,t.newDate(s,E,t.minDay)));var r=this._prepare(w.weekHeader,g).replace(/\{days\}/g,this._generateDayHeaders(g,t,w));return this._prepare(w.month,g).replace(/\{monthHeader(:[^\}]+)?\}/g,f).replace(/\{weekHeader\}/g,r).replace(/\{weeks\}/g,k)},_generateDayHeaders:function(g,h,f){var e=g.options.firstDay;e=(e==null?h.local.firstDay:e);var j="";for(var d=0;d<h.daysInWeek();d++){var i=(d+e)%h.daysInWeek();j+=this._prepare(f.dayHeader,g).replace(/\{day\}/g,'<span class="'+this._curDoWClass+i+'" title="'+h.local.dayNames[i]+'">'+h.local.dayNamesMin[i]+"</span>")}return j},_generateMonthSelection:function(f,r,v,j,q,e,s){if(!f.options.changeMonth){return s.formatDate(e,s.newDate(r,v,1))}var n=s.local["monthNames"+(e.match(/mm/i)?"":"Short")];var p=e.replace(/m+/i,"\\x2E").replace(/y+/i,"\\x2F");var u='<select class="calendars-month '+this._monthYearClass+'" title="'+f.options.monthStatus+'">';var d=s.monthsInYear(r)+s.minMonth;for(var t=s.minMonth;t<d;t++){if((!j||s.newDate(r,t,s.daysInMonth(r,t)-1+s.minDay).compareTo(j)!==-1)&&(!q||s.newDate(r,t,s.minDay).compareTo(q)!==+1)){u+='<option value="'+t+"/"+r+'"'+(v===t?' selected="selected"':"")+">"+n[t-s.minMonth]+"</option>"}}u+="</select>";p=p.replace(/\\x2E/,u);var g=f.options.yearRange;if(g==="any"){u='<select class="calendars-year '+this._monthYearClass+" "+this._anyYearClass+'" title="'+f.options.yearStatus+'"><option>'+convertDigits(r.toString(),f.options.calendar.local.digits)+'</option></select><input class="'+this._monthYearClass+" "+this._curMonthClass+v+'" value="'+r+'">'}else{g=g.split(":");var o=s.today().year();var i=(g[0].match("c[+-].*")?r+parseInt(g[0].substring(1),10):((g[0].match("[+-].*")?o:0)+parseInt(g[0],10)));var h=(g[1].match("c[+-].*")?r+parseInt(g[1].substring(1),10):((g[1].match("[+-].*")?o:0)+parseInt(g[1],10)));u='<select class="calendars-year '+this._monthYearClass+'" title="'+f.options.yearStatus+'">';i=s.newDate(i+1,s.firstMonth,s.minDay).add(-1,"d");h=s.newDate(h,s.firstMonth,s.minDay);var k=function(m){if(m!==0||s.hasYearZero){u+='<option value="'+Math.min(v,s.monthsInYear(m)-1+s.minMonth)+"/"+m+'"'+(r===m?' selected="selected"':"")+">"+convertDigits(m.toString(),f.options.calendar.local.digits)+"</option>"}};if(i.toJD()<h.toJD()){i=(j&&j.compareTo(i)===+1?j:i).year();h=(q&&q.compareTo(h)===-1?q:h).year();for(var l=i;l<=h;l++){k(l)}}else{i=(q&&q.compareTo(i)===-1?q:i).year();h=(j&&j.compareTo(h)===+1?j:h).year();for(var l=i;l>=h;l--){k(l)}}u+="</select>"}p=p.replace(/\\x2F/,u);return p},_prepare:function(h,f){var g=function(k,i){while(true){var l=h.indexOf("{"+k+":start}");if(l===-1){return}var j=h.substring(l).indexOf("{"+k+":end}");if(j>-1){h=h.substring(0,l)+(i?h.substr(l+k.length+8,j-k.length-8):"")+h.substring(l+j+k.length+6)}}};g("inline",f.inline);g("popup",!f.inline);var e=/\{l10n:([^\}]+)\}/;var d=null;while(d=e.exec(h)){h=h.replace(d[0],f.options[d[1]])}return h}});var a=c.calendarsPicker;c(function(){c(document).on("mousedown."+b,a._checkExternalClick).on("resize."+b,function(){a.hide(a.curInst)})})})(jQuery);